@page "/Fido2Mfa/{handler?}"
@using Microsoft.AspNetCore.Identity
@inject SignInManager<ApplicationUser> SignInManager
@inject UserManager<ApplicationUser> UserManager
@model IdentityServer.Areas.Identity.Pages.Account.Manage.Fido2MfaModel
@{
    Layout = "_Layout.cshtml";
    ViewData["Title"] = "Two-factor authentication (2FA)";
    ViewData["ActivePage"] = ManageNavPages.Fido2Mfa;
}

<h4>@ViewData["Title"]</h4>
<p>Enroll your Fido2 authenticator to setup 2FA. Please plug in your authenticator device now.</p>
<div class="notification is-danger" style="display:none">
    Please note: Your browser does not seem to support WebAuthn yet. <a href="https://caniuse.com/#search=webauthn" target="_blank">Supported browsers</a>
</div>
<div class="columns">
    <div class="column is-4">
        <form action="/Fido2Mfa" method="post" id="register">
            <input class="form-control" type="hidden" readonly placeholder="email" value="@User.Claims.Where(x=> x.Type == "sub").First().Value" name="username" required>
            <div class="field">
                <div class="control">
                    <button class="btn btn-primary">Add Fido2 MFA</button>
                </div>
            </div>
        </form>
    </div>
</div>

<script src="~/js/helpers.js"></script>
<script src="~/js/instant.js"></script>
<script src="~/js/mfa.register.js"></script>